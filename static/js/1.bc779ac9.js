"use strict";(self.webpackChunkjira_time_tracker=self.webpackChunkjira_time_tracker||[]).push([[1],{41710:(e,s,t)=>{t.d(s,{_:()=>i});const i={accountId:null,accountType:"",active:!0,applicationRoles:{items:[],size:0},avatarUrls:{"16x16":"","24x24":"","32x32":"","48x48":""},displayName:"Unassigned",emailAddress:"unassigned@gmail.com",groups:{items:[],size:0},key:"",name:"",self:"",timeZone:""}},49245:(e,s,t)=>{t.d(s,{g:()=>i});const i=e=>"app"!==e.accountType&&e.active},31730:(e,s,t)=>{t.d(s,{A:()=>f});var i=t(96540),a=t(81609),n=t(31519),r=t(12828),o=t(87657),l=t(8290),d=t(15490),c=t(53857),u=t(6785),g=t(60659),m=t(97286),p=t(14638),h=t(41710);var x=t(49245),j=t(74848);const f=e=>{const{issueKey:s,assignee:t,onChange:f,position:S="bottom-start"}=e,[y,A]=(0,i.useState)(!1),[v,b]=(0,i.useState)(!1),{data:C,isLoading:I}=(e=>{let{issueKey:s,open:t}=e;return(0,m.I)({queryKey:["assignable issue",s],queryFn:()=>p.S.get("/issue-assignable",{params:{issueKey:s}}),select:e=>[...e.data,h._].sort(((e,s)=>e.displayName.localeCompare(s.displayName))),enabled:t})})({issueKey:s,open:y}),k=v?C:C?.filter(x.g);return(0,i.useEffect)((()=>()=>{b(!1)}),[]),(0,j.jsx)(d.A,{xcss:(0,c.S7)({maxWidth:"size.1000"}),children:(0,j.jsxs)(a.A,{isLoading:I,isOpen:y,onOpenChange:()=>A(!y),placement:S,trigger:e=>(0,j.jsx)(g.A,{...e,ref:e.triggerRef,iconBefore:()=>t?.avatarUrls?.["48x48"]?(0,j.jsx)(l.A,{height:20,width:20,src:t?.avatarUrls?.["48x48"],loading:"lazy"}):(0,j.jsx)(d.A,{xcss:(0,c.S7)({height:"20px",width:"20px"}),children:(0,j.jsx)(o.A,{label:"Unassigned"})}),iconAfter:u.default,children:t?.displayName??"Unassigned"}),children:[(0,j.jsx)(n.A,{children:!I&&k?.map((e=>(0,j.jsx)(r.A,{onClick:()=>f(e),isSelected:e.accountId===(t?t.accountId:t),elemBefore:e?.avatarUrls?.["48x48"]?(0,j.jsx)(l.A,{height:20,width:20,src:e.avatarUrls["48x48"],loading:"lazy"}):(0,j.jsx)(d.A,{xcss:(0,c.S7)({height:"20px",width:"20px"}),children:(0,j.jsx)(o.A,{label:"Unassigned"})}),children:e.displayName},e.accountId)))}),(0,j.jsx)(g.A,{shouldFitContainer:!0,onClick:()=>b((e=>!e)),children:v?"Hide":"Show all"})]})})}},52222:(e,s,t)=>{t.d(s,{A:()=>u});var i=t(97665),a=t(57097),n=t(14638),r=t(31730),o=t(1932),l=t(43164),d=t(82568),c=t(74848);const u=e=>{const{issueKey:s,assignee:t,queryKeys:u,position:g="bottom-start",onSuccess:m}=e,p=(0,i.jE)(),h=(0,l.E)(),x=(0,d.K)(),{mutate:j}=(0,a.n)({mutationFn:e=>n.S.put("/issue-assignee",{accountId:e.accountId},{params:{issueKey:s}}),onMutate:async e=>{const i=[];for(const t of u()){await p.cancelQueries({queryKey:[t]});const a=p.getQueryData([t]);a&&(p.setQueryData([t],(t=>Array.isArray(t)?(0,o.jM)(t,(t=>{const i=t.find((e=>{let{key:t}=e;return t===s}));i&&(i.fields.assignee=e)})):(0,o.jM)(t,(t=>{for(const i of t.pages){const t=i.issues.find((e=>{let{key:t}=e;return t===s}));if(t){t.fields.assignee=e;break}}})))),i.push([t,a]))}const a=`from ${t?.displayName??"Unassigned"} to ${e.displayName}`;return{oldStates:i,dismissFn:h.loading({title:"Assignee changes",description:a}),notificationMessage:a}},onSuccess:(e,s,t)=>{t.dismissFn(),h.success({title:"Assignee changes",description:t.notificationMessage}),"function"==typeof m&&m(),p.invalidateQueries()},onError:(e,s,t)=>{if(t.dismissFn(),x(e),Array.isArray(t?.oldStates))for(const[e,s]of t.oldStates)p.setQueryData([e],(e=>(0,o.jM)(e,(e=>{Object.assign(e,s)}))))}});return(0,c.jsx)(r.A,{assignee:t,issueKey:s,onChange:j,position:g})}},46742:(e,s,t)=>{t.d(s,{u:()=>u});var i=t(97665),a=t(57097),n=t(14638),r=t(1932),o=t(43164),l=t(45366),d=t(82568),c=t(74848);const u=e=>{const{issueId:s,queryKeys:t,status:u,issueName:g,position:m,disabled:p,trigger:h,onMutate:x,xcss:j,onSuccess:f}=e,S=(0,i.jE)(),y=(0,o.E)(),A=(0,d.K)(),{mutate:v,isPending:b}=(0,a.n)({mutationFn:e=>n.S.post("/change-status-task",{taskId:s,transitionId:e.id}),onMutate:async e=>{const i=[];for(const a of t()){await S.cancelQueries({queryKey:[a]});const t=S.getQueryData([a]);t&&(S.setQueryData([a],(t=>Array.isArray(t)?(0,r.jM)(t,(t=>{const i=t.find((e=>{let{id:t}=e;return t===s}));i&&(i.fields.status=e.to)})):(0,r.jM)(t,(t=>{for(const i of t.pages){const t=i.issues.find((e=>{let{id:t}=e;return t===s}));if(t){t.fields.status=e.to;break}}})))),i.push([a,t]))}"function"==typeof x&&await x(e);const a=`from ${u.name} to ${e.name}`;return{dismissFn:y.loading({title:"Status changes",description:a}),notificationMessage:a,oldStates:i}},onSuccess:async(e,s,t)=>{t?.dismissFn(),y.success({title:"Status changes",description:t.notificationMessage}),"function"==typeof f&&await f(),S.invalidateQueries()},onError:(e,s,t)=>{if(t?.dismissFn(),A(e),Array.isArray(t?.oldStates))for(const[e,s]of t.oldStates)S.setQueryData([e],(e=>(0,r.jM)(e,(e=>{Object.assign(e,s)}))))}});return(0,c.jsx)(l.w5,{issueId:s,status:u,position:m,disabled:p,onChange:e=>v(e),trigger:h,xcss:j,isPending:b})}},47198:(e,s,t)=>{t.d(s,{$q:()=>N,iq:()=>d,dJ:()=>O,k9:()=>F,hO:()=>u,P7:()=>i});const i=(0,t(86171).y)((()=>({favorites:[]})));var a=t(43164),n=t(96540),r=t(5642),o=t(58124),l=t(1932);let d=function(e){return e.add="add",e.remove="remove",e.edit="edit",e.choose="choose",e.removeFromAllGroups="removeFromAllGroups",e.empty="",e}({});var c=t(82568);const u=()=>{const e=i((e=>e.favorites)),s=(0,a.E)(),[t,u]=(0,n.useState)(d.empty),g=(0,r.BL)({titleLoading:"",titleError:"",titleSuccess:"",onMutate:e=>{i.setState((s=>{s.favorites=e.settings?.favorites}))},onSuccess:()=>{u(d.empty)},onError:()=>{u(d.empty),i.setState((e=>{e.favorites=o.QN.getState().settings.favorites}))}});(0,c.K)(g.error);return{hasFavorite:(0,n.useCallback)((s=>e.some((e=>{let{issueIds:t}=e;return t.includes(s)}))),[e]),favorites:e,reasonLoading:t,removeFromAllGroups:e=>{const s=(0,l.jM)(i.getState().favorites,(s=>{s.forEach((s=>{s.issueIds.includes(e)&&s.issueIds.splice(s.issueIds.indexOf(e),1)}))}));g.mutate({settings:{favorites:s}}),u(d.removeFromAllGroups)},onAddNewGroup:e=>{if(i.getState().favorites.some((s=>{let{name:t}=s;return t===e})))return void s.error({title:"Such a group has already been added to favorites."});const t=(0,l.jM)(i.getState().favorites,(s=>{s.push({name:e,issueIds:[]})}));g.mutate({settings:{favorites:t}}),u(d.add)},onRemoveGroup:e=>{const s=(0,l.jM)(i.getState().favorites,(s=>{const t=s.findIndex((s=>s.name===e));-1!==t&&s.splice(t,1)}));g.mutate({settings:{favorites:s}}),u(d.remove)},onAddGroup:(e,s)=>{const t=(0,l.jM)(i.getState().favorites,(t=>{const i=t.find((s=>s.name===e));i&&(i.issueIds.includes(s)?i.issueIds.splice(i.issueIds.indexOf(s),1):i.issueIds.push(s))}));g.mutate({settings:{favorites:t}}),u(d.choose)},onEditGroup:(e,t)=>{if(i.getState().favorites.some((e=>{let{name:s}=e;return s===t})))return void s.error({title:"Such a group has already been added to favorites."});const a=(0,l.jM)(i.getState().favorites,(s=>{const i=s.find((s=>s.name===e));i&&(i.name=t)}));g.mutate({settings:{favorites:a}}),u(d.edit)}}};var g=t(60659),m=t(64561),p=t(95995),h=t(77956),x=t(15490),j=t(53857),f=t(52340),S=t(79964),y=t(17673),A=t(12596),v=t(65491),b=t(16060),C=t(3973),I=t(74848);const k=e=>{let{name:s,isGroup:t,issueId:i,isEditGroup:a,isDeleteGroup:r}=e;const[o,l]=(0,n.useState)(s),[c,g]=(0,n.useState)(!1),{reasonLoading:p,onAddGroup:h,onRemoveGroup:f,onEditGroup:k}=u();return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(x.A,{xcss:(0,j.S7)({flex:1}),children:(0,I.jsx)(S.A,{isEditing:c,defaultValue:o,editButtonLabel:o,editView:e=>{let{errorMessage:s,...t}=e;return(0,I.jsx)(y.A,{...t,autoFocus:!0})},readView:()=>(0,I.jsx)(x.A,{xcss:(0,j.S7)({maxWidth:"200px",wordBreak:"break-all"}),children:(0,I.jsx)(A.A,{size:"small",children:o})}),onConfirm:e=>{e&&e!==s&&(k(s,e),l(e),g((e=>!e)))},onCancel:()=>g((e=>!e))})}),(0,I.jsx)(m.A,{appearance:t?"primary":"subtle",icon:v.A,label:"choose",isDisabled:p===d.edit||p===d.remove,isLoading:p===d.choose,onClick:()=>h(s,i)}),a&&(0,I.jsx)(m.A,{appearance:"subtle",icon:b.A,label:"edit",isDisabled:p===d.choose||p===d.remove,isLoading:p===d.edit,onClick:()=>g((e=>!e))}),r&&(0,I.jsx)(C.w,{title:"Are you sure you want to delete this group?",isLoading:p===d.remove,isDisabled:p===d.choose||p===d.edit,onYes:()=>{f(s)}})]})};var w=t(49560),E=t(96077),L=t(49188);const N=e=>{const{isLoading:s,onAdd:t}=e,i=(0,n.useRef)(null);return(0,I.jsxs)(f.A,{xcss:(0,j.S7)({height:"30px",marginBottom:"space.100","& > div, & > button":{height:"inherit"}}),alignItems:"center",columnGap:"space.100",children:[(0,I.jsx)(y.A,{ref:i}),(0,I.jsx)(m.A,{appearance:"primary",icon:L.A,label:"add",isLoading:s,onClick:()=>{i.current&&(t(i.current.value),i.current.value="")}})]})},O=e=>{const{children:s}=e;return(0,I.jsx)(x.A,{xcss:(0,j.S7)({padding:"space.200",minWidth:"400px"}),children:s})},F=e=>{const{issueId:s,isEditGroup:t=!0,isDeleteGroup:a=!0,isAddNewGroup:r=!0,isButtonCompact:l=!1}=e,[c,S]=(0,n.useState)(!1),{reasonLoading:y,onAddNewGroup:A,removeFromAllGroups:v,hasFavorite:b,favorites:C}=u();return(0,n.useEffect)((()=>{i.setState((e=>{e.favorites=o.QN.getState().settings.favorites}))}),[]),(0,I.jsx)(h.A,{isOpen:c,onClose:()=>S(!1),placement:"bottom-start",content:()=>(0,I.jsxs)(O,{children:[(0,I.jsxs)(x.A,{xcss:(0,j.S7)({overflowY:"auto",overflowX:"hidden",maxHeight:"300px",paddingBottom:"space.600",marginBottom:"space.300"}),children:[0===C.length&&(0,I.jsx)(E.A,{header:"No groups have been added yet."}),C.map(((e,i)=>{let{name:n,issueIds:r}=e;return(0,I.jsx)(f.A,{xcss:(0,j.S7)({marginBottom:"space.200",minHeight:"30px","& input, & > button":{height:"30px"},"& form > div":{margin:0},"&:last-child":{marginBottom:0}}),columnGap:"space.050",alignItems:"center",children:(0,I.jsx)(k,{name:n,isGroup:r.includes(s),issueId:s,isDeleteGroup:a,isEditGroup:t})},n)}))]}),r&&(0,I.jsx)(N,{isLoading:y===d.add,onAdd:A}),(0,I.jsx)(g.A,{appearance:"default",shouldFitContainer:!0,isDisabled:!b(s),onClick:()=>v(s),isLoading:y===d.removeFromAllGroups,children:"Remove the issue from all its groups."})]}),trigger:e=>(0,I.jsx)(m.A,{...e,icon:b(s)?w.A:p.A,label:"Favorite",appearance:"default",spacing:l?"compact":"default",onClick:()=>S(!c)})})}},67898:(e,s,t)=>{t.d(s,{P:()=>f,b:()=>o.b});var i=t(72288),a=t(16371),n=t(24681),r=t(96871),o=t(75946),l=t(3973),d=t(96540),c=t(74353),u=t.n(c);var g=t(81609),m=t(12828),p=t(67459),h=t(74848);const x=e=>{const{issueId:s,isAddToTimeSpentAction:t,isLogTimeAction:o,timeSpentSeconds:c,onAddToTimeSpent:x,remove:j,clear:f,LogTimeAutoComponent:S,invalidateQueries:y}=e,[A,v]=(0,d.useState)(!1),[b,C]=(0,d.useState)(!1),I=(0,n.M)(c,!0),k=(e=>{const[s,t]=(0,d.useState)(""),i=(0,d.useCallback)((()=>{const e=u()(),s=u()().endOf("day").add(1,"second").diff(e),i=Math.floor(s/36e5)%24,a=Math.floor(s/6e4)%60,n=Math.floor(s/1e3)%60;t(`${i}h ${a}m ${n}s`)}),[]);return(0,d.useEffect)((()=>{i();const s=setInterval(i,1e3),t=u()(),a=u()().endOf("day").add(1,"second").diff(t),n=setTimeout((()=>{e();const s=setInterval(e,864e5);return()=>clearInterval(s)}),a);return()=>{clearTimeout(n),clearInterval(s)}}),[e,i]),s})(f);return(0,h.jsxs)(i.A,{title:`Error During Logging at ${I}`,appearance:A?"success":"error",actions:[(0,h.jsx)(a.A,{href:"#",children:(0,h.jsx)(l.w,{title:"Are you sure you want to delete this time entry?",onYes:()=>{j(s)},children:e=>{let{triggerProps:s,setIsOpen:t}=e;return(0,h.jsx)("div",{...s,onClick:()=>t((e=>!e)),children:"Delete"})}})}),t&&(0,h.jsx)(a.A,{href:"#",onClick:()=>{x?.(c),v(!0)},children:"Add to Time Spent"}),o&&S&&(0,h.jsxs)(g.A,{isOpen:b,onOpenChange:()=>C((e=>!e)),trigger:e=>(0,h.jsx)(a.A,{href:"#",children:(0,h.jsx)("div",{...e,ref:e.triggerRef,children:"Log time"})}),children:[(0,h.jsx)(m.A,{onClick:e=>{e.stopPropagation(),r.vR.setTrue("LOG_TIME_ISSUE",s)},children:"Manual"}),(0,h.jsx)(S,{issueId:s,invalidateQueries:y,onSuccess:()=>j(s),children:e=>{let{onLogTime:s,isLoading:t}=e;return(0,h.jsx)(m.A,{isDisabled:t,onClick:e=>{e.stopPropagation(),s(c)},elemAfter:t&&(0,h.jsx)(p.A,{size:"small"}),children:"Auto Log"})}})]})].filter((e=>!1!==e&&void 0!==e)),children:["An error occurred, possibly due to server issues or other problems. You can manually log the time if necessary. If not logged, this entry will be removed in ",(0,h.jsx)("strong",{children:k}),"."]})},j=e=>{const{issueId:s,isLogTimeAction:t=!0,invalidateQueries:i}=e,{lostTime:a,remove:n,clear:r}=(0,o.b)(s);return a&&(0,h.jsx)(x,{...e,remove:n,clear:r,invalidateQueries:i,isLogTimeAction:t,timeSpentSeconds:a.timeSpentSeconds})},f=(0,d.memo)(j)},75946:(e,s,t)=>{t.d(s,{b:()=>c});var i=t(74353),a=t.n(i),n=t(35806),r=t(96540);const o="PERSIST_LOST_TIME",l=new Map,d=new Map,c=e=>{const s=(0,r.useCallback)((()=>{try{const e=localStorage.getItem(o);return e?JSON.parse(e):[]}catch(e){return[]}}),[]),t=(0,r.useCallback)((e=>{localStorage.setItem(o,JSON.stringify(e))}),[]),i=(0,r.useCallback)((()=>{const i=s();if(i){const s=i.find((s=>s.issueId===e));s&&(a()(s.date).isToday()||(t(i.filter((s=>s.issueId!==e))),l.delete(e)))}}),[e]),c=(0,r.useCallback)((()=>{i();const t=s();if(e)if(t){const s=t.find((s=>s.issueId===e));l.set(e,s??null)}else l.set(e,null)}),[i]);(0,r.useLayoutEffect)(c,[e,c]);const u=(0,r.useCallback)((e=>{const i=s();i.find((s=>s.issueId===e))&&t(i.filter((s=>s.issueId!==e))),l.delete(e),d.get(e)?.forEach((e=>e()))}),[e]),g=(0,r.useCallback)((i=>{const r=s();if(r.length>0){const s=r.find((s=>s.issueId===e));s?(t([...r.filter((s=>s.issueId!==e)),{...s,timeSpentSeconds:i+s.timeSpentSeconds}]),l.set(e,{...s,timeSpentSeconds:i+s.timeSpentSeconds})):(t([...r,{issueId:e,date:a()().format(n.D),timeSpentSeconds:i}]),l.set(e,{issueId:e,date:a()().format(n.D),timeSpentSeconds:i}))}else t([{issueId:e,date:a()().format(n.D),timeSpentSeconds:i}]),l.set(e,{issueId:e,date:a()().format(n.D),timeSpentSeconds:i});d.get(e)?.forEach((e=>e()))}),[e]),m=(0,r.useSyncExternalStore)((s=>{if(d.has(e)){const t=d.get(e);d.set(e,[...t,s])}else d.set(e,[s]);const t=s=>{s.key===o&&(c(),d.get(e)?.forEach((e=>e())))};return window.addEventListener("storage",t),()=>{if(d.has(e)){const t=d.get(e);d.set(e,t.filter((e=>e!==s)))}window.removeEventListener("storage",t)}}),(()=>l.get(e)));return{add:g,remove:u,clear:i,lostTime:m}}},53001:(e,s,t)=>{t.d(s,{ErrorBoundary:()=>ts,IssuesPage:()=>es});var i=t(58059),a=t(20984),n=t(14638);const r=async e=>{const s=await n.S.post("/jql-search",{includeCollapsedFields:!0},{params:{url:e}});return{jqlFields:s.data.visibleFieldNames,jqlFunctions:s.data.visibleFunctionNames}},o=async e=>(await n.S.get("/jql-search",{params:{url:e}})).data;var l=t(96540),d=t(58124),c=t(5642),u=t(97665),g=t(82568),m=t(74848);const p=()=>{const e=(0,d.QN)((e=>e.jql)),s=(0,u.jE)(),t=(0,c.BL)({titleLoading:"Searching",titleSuccess:"",titleError:"Filter update error",onSuccess:()=>{s.invalidateQueries({queryKey:["issues"]})}});(0,g.K)(t.error);const n=(0,a.B)("autocomplete",r,o);return(0,m.jsx)(i.$,{isSearching:!1,analyticsSource:"autocomplete",query:e,onSearch:(e,s)=>{0===s.errors.length&&s.represents!==d.QN.getState().jql&&t.mutate({jql:e,settings:{jqlUISearchModeSwitcher:"jql",jqlBasic:null}})},autocompleteProvider:n,locale:"en"})},h=(0,l.memo)(p);var x=t(96035),j=t(46742),f=t(52222),S=t(64561),y=t(28107),A=t(52340),v=t(15490),b=t(53857),C=t(72288),I=t(75396),k=t(74353),w=t.n(k);const E=(e,s)=>{const{children:t}=e,i=(0,l.useRef)({pause:!1,seconds:0}),[a,n]=(0,l.useState)(w()().startOf("day")),r=a.format("HH:mm:ss");return i.current.seconds=3600*a.hour()+60*a.minute()+a.second(),(0,l.useEffect)((()=>{let e;return e=setInterval((()=>{i.current.pause||n((e=>e.add(1,"second")))}),1e3),()=>clearInterval(e)}),[]),(0,l.useImperativeHandle)(s,(()=>({pause:()=>{i.current.pause=!0},play:()=>{i.current.pause=!1},setIntervalTrigger:(e,s)=>{let t=e;const a=setInterval((()=>{i.current.seconds>=t&&!i.current.pause&&(t+=e,s())}),1e3);return()=>{n(w()().startOf("day")),clearInterval(a)}}}))),t(r)},L=(0,l.forwardRef)(E);var N=t(1932),O=t(97066),F=t(47198),T=t(75946);const M=e=>{const s=(e=>{const s=(0,u.jE)(),t=(0,l.useRef)(null),i=(0,l.useRef)([]),{add:a}=(0,T.b)(e),n=(0,l.useSyncExternalStore)((e=>x.t.subscribe(e)),(()=>x.t.isOnline())),r=(0,d.QN)((e=>e.settings.timeLoggingInterval.second)),o=(0,d.QN)((e=>e.isTimeLoggingPaused)),c=(0,d.QN)((e=>e.isIdleWithInsufficientActivity)),g=(0,l.useCallback)((()=>[...F.P7.getState().favorites.map((e=>{let{name:s}=e;return`favorite group ${s}`})),"issues tracking"]),[]),m=(0,l.useCallback)((e=>{const t=[];for(const i of g()){const a=s.getQueryData([i]);a&&(s.setQueryData([i],(s=>(0,N.jM)(s,(s=>{for(const t of s)if(t.id===e.issueId){null===t.fields.timespent&&(t.fields.timespent=0),t.fields.timespent+=r;break}})))),t.push([i,a]))}return t}),[e]),p=(0,l.useCallback)(((e,t,i)=>{if(Array.isArray(i))for(const[e,t]of i)s.setQueryData([e],(e=>(0,N.jM)(e,(e=>{Object.assign(e,t)}))))}),[]),{issueWorklogs:h,worklogPUT:j,worklogPOST:f}=(0,O.r)({issueId:e,from:w()().startOf("day"),to:w()().endOf("day"),enabledAllNotifications:!1,enabledGetWorklogs:!1,enabledGetIssueWorklogs:!1,post:{onMutate:m,onError:p},put:{onMutate:m,onError:p}});(0,l.useEffect)((()=>{null===j.error&&null===f.error||a(r)}),[j.error,f.error,r]);const S=(0,l.useCallback)((async()=>{await h.refetch().then((s=>{if(null!==s.error)return a(r);if(s.data&&s.data.length>0){const t=s?.data[0],i=t.timeSpentSeconds+r;j.mutate({issueId:e,id:t.id,startDate:t.date,timeSpentSeconds:i,timeSpent:"",description:t.description})}else{const s=r;f.mutate({issueId:e,timeSpentSeconds:s,timeSpent:""})}})).catch((()=>{}))}),[r]);return(0,l.useEffect)((()=>t.current?.setIntervalTrigger(r,S)),[r]),(0,l.useEffect)((()=>(!n||o||!i.current[0]&&c?t.current?.pause():t.current?.play(),()=>{i.current.length>1&&i.current.splice(0,1),0===i.current.length?i.current.push(n,n):i.current.push(n)})),[o,n,c]),t})(e.issueId);return(0,m.jsx)(L,{ref:s,children:s=>(0,m.jsxs)(v.A,{xcss:(0,b.S7)({backgroundColor:"color.background.neutral",borderTopLeftRadius:"border.radius.200",borderTopRightRadius:"border.radius.200",textAlign:"center",font:"font.heading.xlarge",fontWeight:"font.weight.bold",color:"color.text.accent.blue.bolder",marginBottom:"space.150"}),children:[s,e.indicatorSlot]})})},R=e=>{const{onSuccess:s,invalidateQueries:t}=e,{onLogTime:i,isLoading:a,isMutationSuccess:n}=((e,s)=>{const[t,i]=(0,l.useState)(!1),a=(0,u.jE)(),n=(0,l.useCallback)((async()=>{if("function"!=typeof s)return i(!1);await Promise.all(s().map((e=>a.invalidateQueries({queryKey:[e]})))),i(!1)}),[s]),{issueWorklogs:r,worklogPUT:o,worklogPOST:d}=(0,O.r)({issueId:e,from:w()().startOf("day"),to:w()().endOf("day"),enabledGetWorklogs:!1,enabledGetIssueWorklogs:!1,post:{onMutate:()=>{},onSuccess:()=>{n()},onError:()=>{i(!1)}},put:{onMutate:()=>{},onSuccess:()=>{n()},onError:()=>{i(!1)}}});return{onLogTime:(0,l.useCallback)((async s=>{const t=await r.refetch();if(i(!0),t.data&&t.data.length>0){const i=t?.data[0],a=i.timeSpentSeconds+s;o.mutate({issueId:e,id:i.id,startDate:i.date,timeSpentSeconds:a,timeSpent:"",description:i.description})}else d.mutate({issueId:e,timeSpentSeconds:s,timeSpent:""})}),[]),isLoading:r.isFetching||t,isMutationSuccess:!t&&(o.isSuccess||d.isSuccess)}})(e.issueId,t);return(0,l.useEffect)((()=>{n&&s?.()}),[s,n]),e.children({onLogTime:i,isLoading:a,isMutationSuccess:n})};var D=t(45366),P=t(24681);const q=e=>"number"==typeof e&&e>0,K=e=>null===e||0===e,$=e=>{const{fields:s}=e,{timeLogged:t,timeRemaining:i,timeLoggedWidth:a,overEstimateWidth:n,timeRemainingFromOriginalEstimate:r}=(e=>{const s=(0,d.QN)((e=>e.settings.useStoryPointsAsTimeEstimate)),t=(0,d.QN)((e=>e.settings.storyPointField)),i=e.fields[t];return(0,l.useMemo)((()=>{const{fields:t}=e;let{timespent:a,timeestimate:n,timeoriginalestimate:r}=t;if(s&&"number"==typeof i&&(r=w().duration(i,"hours").asSeconds()),K(a)&&q(n)&&q(r)&&n===r)return{timeLogged:"No time logged",timeRemaining:`${(0,P.M)(n)} remaining`,timeRemainingFromOriginalEstimate:`${(0,P.M)(r)} from original estimate`,timeLoggedWidth:"0",overEstimateWidth:"0"};if(K(a)&&q(n)&&q(r)&&n>r)return{timeLogged:"No time logged",timeRemaining:`${(0,P.M)(n)} remaining`,timeRemainingFromOriginalEstimate:`${(0,P.M)(r)} from original estimate`,timeLoggedWidth:"0",overEstimateWidth:(n-r)/n*100+"%"};if(K(a)&&q(n)&&q(r)&&n<r)return{timeLogged:"No time logged",timeRemaining:`${(0,P.M)(n)} remaining`,timeRemainingFromOriginalEstimate:`${(0,P.M)(r)} from original estimate`,timeLoggedWidth:"0",overEstimateWidth:"0"};if(K(a)&&K(n)&&q(r)&&r>0)return{timeLogged:"No time logged",timeRemaining:`${(0,P.M)(r)} remaining`,timeRemainingFromOriginalEstimate:`${(0,P.M)(r)} from original estimate`,timeLoggedWidth:"0",overEstimateWidth:"0"};if(q(a)&&K(n)&&q(r)&&a<r)return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:"",timeRemainingFromOriginalEstimate:`${(0,P.M)(r-a)} remaining`,timeLoggedWidth:a/r*100+"%",overEstimateWidth:"0"};if(q(a)&&K(n)&&q(r)&&a===r)return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:"",timeRemainingFromOriginalEstimate:"",timeLoggedWidth:"100%",overEstimateWidth:"0"};if(q(a)&&K(n)&&q(r)&&a>r){const e=r/a*100;return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:"",timeRemainingFromOriginalEstimate:`-${(0,P.M)(a-r)} remaining`,timeLoggedWidth:`${e}%`,overEstimateWidth:100-e+"%"}}if(q(a)&&q(n)&&q(r)&&a+n===r){const e=a/r*100;return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:`${(0,P.M)(n)} remaining`,timeRemainingFromOriginalEstimate:`${(0,P.M)(r-a)} from original estimate`,timeLoggedWidth:`${e}%`,overEstimateWidth:"0"}}if(q(a)&&q(n)&&q(r)&&a+n<r){const e=a/r*100;return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:`${(0,P.M)(n)}  remaining`,timeRemainingFromOriginalEstimate:`${(0,P.M)(r-a)} from original estimate`,timeLoggedWidth:`${e}%`,overEstimateWidth:"0"}}if(q(a)&&q(n)&&q(r)&&a+n>r){const e=a+n,s=(e-r)/e*100;return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:`${(0,P.M)(n)}  remaining`,timeRemainingFromOriginalEstimate:`${a>r?"-":""}${(0,P.M)(a>r?a-r:r-a)} from original estimate`,timeLoggedWidth:100-s+"%",overEstimateWidth:`${s}%`}}if(q(a)&&K(n)&&K(r))return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:"",timeRemainingFromOriginalEstimate:"",timeLoggedWidth:"100%",overEstimateWidth:""};if(q(a)&&q(n)&&K(r)){const e=a/(a+n)*100;return{timeLogged:`${(0,P.M)(a)} logged`,timeRemaining:`${(0,P.M)(n)} remaining`,timeRemainingFromOriginalEstimate:"Original estimate not provided",timeLoggedWidth:`${e}%`,overEstimateWidth:"0"}}return{timeLogged:"No time logged",timeRemaining:"",timeRemainingFromOriginalEstimate:"",timeLoggedWidth:"0",overEstimateWidth:"0"}}),[e.fields,s,t,i])})({fields:s});return(0,m.jsxs)(v.A,{xcss:(0,b.S7)({position:"relative",display:"flex",justifyContent:"space-between",marginTop:"space.075",height:"6px",backgroundColor:"color.background.neutral"}),children:[(0,m.jsx)(v.A,{xcss:(0,b.S7)({position:"absolute",top:"calc(100% + 3px)",left:"0",fontSize:"x-small",lineHeight:1,color:"color.text.accent.gray"}),children:t}),(0,m.jsxs)(v.A,{xcss:(0,b.S7)({position:"absolute",top:"calc(100% + 3px)",right:"0",fontSize:"x-small",lineHeight:1,color:"color.text.accent.gray",textAlign:"right"}),children:[(0,m.jsx)("div",{children:i}),(0,m.jsx)("div",{children:r})]}),(0,m.jsx)(v.A,{xcss:(0,b.S7)({height:"inherit",backgroundColor:"color.background.information.bold",flexBasis:a})}),(0,m.jsx)(v.A,{xcss:(0,b.S7)({height:"inherit",backgroundColor:"color.background.danger.bold",flexBasis:n})})]})};var B=t(67898),U=t(97286),W=t(96077),G=t(53049),Q=t(84017),_=t(18720),z=t(6785),V=t(8290),H=t(85593),J=t(5542),Y=t(54707);const X=(0,l.memo)((e=>{const{isRelatedIssuesLoad:s,parentIssue:t,id:i,issueKey:a,fields:n,RenderRelatedIssues:r,queryKey:o}=e,[c,g]=(0,l.useState)(!1),p=(0,d.QN)((e=>e.issueIdsSearchParams.currentParams.includes(i))),h=(0,u.jE)(),x="new"===n.status.statusCategory.key&&"default",f="indeterminate"===n.status.statusCategory.key&&"inprogress",y="done"===n.status.statusCategory.key&&"success",A=x||f||y||"default",v=(0,l.useMemo)((()=>h.getQueryData(o)?.findIndex((e=>e.id===i))),[o]),b=(0,l.useMemo)((()=>"done"===n.status.statusCategory.key),[n.status.statusCategory.key]),C=(0,l.useMemo)((()=>b?{textDecoration:"line-through"}:{}),[b]),I=(0,l.useCallback)((async()=>{await d.QN.getState().changeIssueIdsSearchParams("add",i)}),[i]);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(G.Ay,{iconSlot:s&&(0,m.jsx)("div",{onClick:()=>g(!c),style:{cursor:"pointer"},children:c?(0,m.jsx)(_.A,{label:""}):(0,m.jsx)(z.default,{label:""})}),typeSlot:(0,m.jsx)(Q.A,{content:n.issuetype.name,children:e=>(0,m.jsx)("div",{...e,style:{display:"flex"},children:(0,m.jsx)(V.A,{src:n.issuetype.iconUrl})})}),keySlot:(0,m.jsx)("span",{style:C,children:a}),summarySlot:n.summary,favoriteSlot:(0,m.jsx)(F.k9,{issueId:i,isButtonCompact:!0}),prioritySlot:(0,m.jsx)(Q.A,{content:n.priority.name,children:e=>(0,m.jsx)("div",{...e,style:{display:"flex"},children:(0,m.jsx)(V.A,{src:n.priority.iconUrl,width:"20px",height:"20px"})})}),assigneeSlot:(0,m.jsx)(Q.A,{content:n.assignee?.displayName,children:e=>(0,m.jsx)("div",{...e,children:(0,m.jsx)(H.A,{name:n.assignee?.displayName,src:n.assignee?.avatarUrls["24x24"],size:"small"})})}),statusSlot:(0,m.jsx)(J.A,{appearance:A,children:n.status.name}),playerSlot:(0,m.jsx)(j.u,{issueId:i,issueName:n.summary,status:n.status,queryKeys:()=>[],position:"left",onMutate:I,trigger:(e,s)=>(0,m.jsx)(S.A,{...e,ref:e.triggerRef,isDisabled:p,isLoading:s,icon:Y.A,isTooltipDisabled:!1,tooltip:{content:p?"Already tracking":"Play"},label:"Play",spacing:"compact"})})}),c&&(0,m.jsx)(G.BX,{marginLeft:`calc(var(--ds-space-250, 20px) + ${(v||0)+1}px)`,children:(0,m.jsx)(r,{issueId:i})})]})}));var Z=t(12596);const ee=(0,l.memo)((e=>{const{issueId:s}=e,t=(0,l.useMemo)((()=>["linked issues",s]),[s]),{data:i,isLoading:a,error:r}=(0,U.I)({queryKey:t,queryFn:async e=>{const t=await n.S.get("/issue",{params:{id:s},signal:e.signal}),i=t.data.fields.issuelinks;if(0===i.length)return[];const a=i.map((e=>e.inwardIssue?.id||e.outwardIssue?.id)),r=await n.S.get("/issues",{params:{jql:`issue in (${a.join(",")})`,startAt:0,maxResults:a.length},signal:e.signal}),o=t.data.fields.issuelinks.reduce(((e,s)=>{const i=r.data.issues.find((e=>e.id===(s.inwardIssue?.id||s.outwardIssue?.id))),a=s.inwardIssue,n=s.outwardIssue;return i&&n&&e.push({type:s.type.outward,id:n.id,issueKey:n.key,isRelatedIssuesLoad:!1,parentIssue:{key:t.data.key,summary:t.data.fields.summary},fields:{summary:n.fields.summary,issuetype:n.fields.issuetype,status:n.fields.status,priority:n.fields.priority,assignee:i.fields.assignee}}),i&&a&&e.push({type:s.type.inward,id:a.id,issueKey:a.key,isRelatedIssuesLoad:i.fields.issuelinks.length>0,parentIssue:{key:t.data.key,summary:t.data.fields.summary},fields:{summary:a.fields.summary,issuetype:a.fields.issuetype,status:a.fields.status,priority:a.fields.priority,assignee:i.fields.assignee}}),e}),[]);return Object.entries(Object.groupBy(o,(e=>e.type)))}});return(0,g.K)(r),(0,m.jsxs)(D.mc,{children:[a&&(0,m.jsx)(W.A,{isLoading:!0,header:""}),i?.map((e=>{let[s,i]=e;return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(Z.A,{size:"small",children:s}),(0,m.jsx)(D.uK,{children:i.map((e=>(0,m.jsx)(X,{...e,queryKey:t,RenderRelatedIssues:ee},e.id)))})]})}))]})})),se=(0,l.memo)((e=>{const{issueId:s}=e,t=(0,l.useMemo)((()=>["child issues",s]),[s]),{data:i,isLoading:a,error:r}=(0,U.I)({queryKey:t,queryFn:async e=>{const t=await n.S.get("/issue",{params:{id:s},signal:e.signal}),i=t.data.fields.subtasks.map((e=>e.id));if(0===i.length)return[];const a=await n.S.get("/issues",{params:{jql:`issue in (${i.map((e=>e)).join(",")})`,startAt:0,maxResults:i.length},signal:e.signal});return i.reduce(((e,s)=>{const i=a.data.issues.find((e=>e.id===s));return i&&e.push({id:i.id,issueKey:i.key,isRelatedIssuesLoad:i.fields.subtasks.length>0,parentIssue:{key:t.data.key,summary:t.data.fields.summary},fields:{summary:i.fields.summary,issuetype:i.fields.issuetype,status:i.fields.status,priority:i.fields.priority,assignee:i.fields.assignee}}),e}),[])}});return(0,g.K)(r),(0,m.jsxs)(D.mc,{children:[a&&(0,m.jsx)(W.A,{isLoading:!0,header:""}),(0,m.jsx)(D.uK,{children:i?.map((e=>(0,m.jsx)(X,{...e,queryKey:t,RenderRelatedIssues:se},e.id)))})]})})),te=e=>{const{fields:s,id:t,issueKey:i}=e,[a,n]=(0,l.useState)(!1),r=(0,l.useCallback)((()=>["issues tracking"]),[]),o=(0,l.useSyncExternalStore)(x.t.subscribe,(()=>x.t.isOnline())),c=(0,D.ye)(s);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(D.qF,{active:!0,children:[(0,m.jsx)(M,{issueId:t,indicatorSlot:(0,m.jsx)($,{fields:s})}),(0,m.jsx)(B.P,{issueId:t,LogTimeAutoComponent:R,invalidateQueries:r}),!o&&(0,m.jsx)(C.A,{title:"Time Logging Paused Due to Internet Absence",appearance:"error",children:"Time logging has been paused because the internet connection is currently unavailable. Once the connection is restored, time tracking will resume automatically."}),!a&&"indeterminate"!==s.status.statusCategory.key&&(0,m.jsx)(C.A,{title:"Incorrect Issue Status for Time Logging",appearance:"warning",children:'This issue is not in the "In Progress" status; please change its status. Currently, time continues to be logged for it.'}),(0,m.jsx)(D.FT,{fields:s}),(0,m.jsx)(D.Ke,{issueKey:i,created:s.created,issueTypeIconUrl:s.issuetype.iconUrl,issueTypeName:s.issuetype.name,projectName:s.project.name,priorityIconUrl:s.priority.iconUrl,avatarUrl:s.project.avatarUrls["32x32"],priorityName:s.priority.name}),(0,m.jsxs)(A.A,{justifyContent:"space-between",alignItems:"center",gap:"space.100",wrap:"wrap",children:[(0,m.jsxs)(A.A,{gap:"space.100",wrap:"wrap",children:[(0,m.jsx)(j.u,{issueId:t,issueName:s.summary,status:s.status,queryKeys:r,trigger:s.status.name,xcss:c.STATUTES_DROPDOWN_BUTTON}),(0,m.jsx)(f.A,{assignee:s.assignee,issueName:s.summary,issueKey:i,queryKeys:r}),(0,m.jsx)(I.g,{issueId:t}),(0,m.jsx)(F.k9,{issueId:t})]}),(0,m.jsx)(j.u,{issueId:t,issueName:s.summary,status:s.status,queryKeys:()=>[],onSuccess:async()=>{n(!0),await d.QN.getState().changeIssueIdsSearchParams("delete",t),n(!1)},trigger:(e,s)=>(0,m.jsx)(S.A,{...e,ref:e.triggerRef,isLoading:a||s,icon:y.A,label:"Stop tracking"})})]}),(0,m.jsx)(D.iq,{isShowLinkedIssues:s.issuelinks.length>0,isShowChildIssues:s.subtasks.length>0,countChildIssues:s.subtasks.length,countLinkedIssues:s.issuelinks.length,children:e=>{let{activityFeed:s}=e;return"Linked issues"===s?(0,m.jsx)(ee,{issueId:t}):"Child issues"===s?(0,m.jsx)(se,{issueId:t}):null}})]}),(0,m.jsx)(v.A,{xcss:(0,b.S7)({height:"5px",width:"100%",backgroundColor:"color.background.inverse.subtle.hovered",marginTop:"space.300",marginBottom:"space.300",borderRadius:"border.radius.200"})})]})},ie=(0,l.memo)(te);var ae=t(43164);const ne=()=>{const e=(0,ae.E)(),{data:s,error:t}=(0,D.HM)({onReject:s=>{e.error({title:`Issue ${s.config?.params.id}`,description:s.response?.data.errorMessages.join(", ")})}});return(0,g.K)(t),s?.map((e=>(0,m.jsx)(ie,{issueKey:e.key,fields:e.fields,id:e.id},e.id)))},re=e=>{const{fields:s,id:t,issueKey:i}=e,a=(0,d.QN)((e=>e.issueIdsSearchParams.currentParams.includes(t))),n=(0,l.useCallback)((()=>["issues"]),[]),r=(0,D.ye)(s);return(0,m.jsxs)(D.qF,{active:!1,children:[(0,m.jsx)(D.FT,{fields:s}),(0,m.jsx)(B.P,{issueId:t,LogTimeAutoComponent:R,invalidateQueries:n}),(0,m.jsx)(D.Ke,{issueKey:i,created:s.created,issueTypeIconUrl:s.issuetype.iconUrl,issueTypeName:s.issuetype.name,projectName:s.project.name,priorityIconUrl:s.priority.iconUrl,avatarUrl:s.project.avatarUrls["32x32"],priorityName:s.priority.name}),(0,m.jsxs)(A.A,{justifyContent:"space-between",gap:"space.100",wrap:"wrap",children:[(0,m.jsxs)(A.A,{gap:"space.100",wrap:"wrap",children:[(0,m.jsx)(j.u,{issueId:t,issueName:s.summary,status:s.status,queryKeys:n,trigger:s.status.name,xcss:r.STATUTES_DROPDOWN_BUTTON}),(0,m.jsx)(f.A,{assignee:s.assignee,issueName:s.summary,issueKey:i,queryKeys:n}),(0,m.jsx)(I.g,{issueId:t}),(0,m.jsx)(F.k9,{issueId:t})]}),(0,m.jsx)(j.u,{issueId:t,issueName:s.summary,status:s.status,queryKeys:n,position:"left",onMutate:async()=>{await d.QN.getState().changeIssueIdsSearchParams("add",t)},disabled:!1,trigger:(e,s)=>(0,m.jsx)(S.A,{...e,isLoading:s,isDisabled:a,ref:e.triggerRef,isTooltipDisabled:!1,tooltip:{content:a?"Already tracking":"Play"},icon:Y.A,label:"Play"})})]}),(0,m.jsx)(D.iq,{isShowLinkedIssues:s.issuelinks.length>0,isShowChildIssues:s.subtasks.length>0,countChildIssues:s.subtasks.length,countLinkedIssues:s.issuelinks.length,children:e=>{let{activityFeed:s}=e;return"Linked issues"===s?(0,m.jsx)(ee,{issueId:t}):"Child issues"===s?(0,m.jsx)(se,{issueId:t}):null}})]})},oe=(0,l.memo)(re);var le=t(60659),de=t(85692),ce=t(53110),ue=t(67459);const ge=()=>{const{ref:e,inView:s}=(0,de.Wx)(),{data:t,error:i,isLoading:a,isFetching:n,isFetchingNextPage:r,hasNextPage:o,fetchNextPage:c}=(0,D.gJ)({jql:()=>d.QN.getState().jql}),u=(0,g.K)(i);return(0,l.useEffect)((()=>{u(ce.pe)}),[]),(0,l.useEffect)((()=>{s&&!n&&c()}),[s,n]),(0,m.jsxs)(m.Fragment,{children:[n&&0===t?.pages[0]?.issues.length&&(0,m.jsx)(W.A,{header:"",description:(0,m.jsx)(ue.A,{})}),!a&&!n&&(0===t?.pages[0]?.issues.length||!t?.pages.length)&&(0,m.jsx)(W.A,{header:"No Issues Found",description:"There are no issues matching your criteria. Please check your filters or search settings, or try again later."}),t?.pages.map((e=>e.issues.map((e=>(0,m.jsx)(oe,{issueKey:e.key,fields:e.fields,id:e.id},e.id))))),!a&&t?.pages&&t?.pages[0]?.issues.length>0&&(0,m.jsx)(v.A,{xcss:(0,b.S7)({marginTop:"space.400"}),children:(0,m.jsxs)(le.A,{appearance:r?"default":o?"primary":"default",onClick:()=>c(),shouldFitContainer:!0,children:[r?"Loading more...":o?"Load More":"Nothing more to load",(0,m.jsx)(v.A,{ref:e,xcss:(0,b.S7)({display:r?"none":"block"})})]})})]})};var me=t(81609),pe=t(50036),he=t(51144);const xe=e=>{const{values:s,title:t,triggerButtonProps:i}=e,a=Array.isArray(s)&&s?.length>0,n="string"==typeof s&&""!==s;return(0,m.jsx)(v.A,{xcss:(0,b.S7)({...(a||n)&&{"& > button, & > button:hover":{backgroundColor:"var(--ds-background-selected, #E9F2FF)",color:"var(--ds-text-selected, #0C66E4)"}}}),children:(0,m.jsxs)(le.A,{...i,ref:i.triggerRef,iconAfter:z.default,children:["string"==typeof s&&t,a&&(0,m.jsxs)(m.Fragment,{children:[t," ",(0,m.jsx)(he.A,{appearance:"primary",children:1===s?.length?s?.length:`+${s?.length}`})]})]})})},je=e=>{const{projectIds:s=[],values:t,onChange:i,elemAfterDropdownItems:a}=e,[r,o]=(0,l.useState)(!1),d=(e=>{const{projectIds:s,opened:t}=e;return(0,U.I)({enabled:t,queryKey:["statuses"],queryFn:async()=>{const e=async()=>({values:(await n.S.get("/jql-search",{params:{url:"/rest/api/latest/jql/autocompletedata/suggestions?fieldName=status"}})).data.results.map((e=>({id:e.value,name:e.displayName,statusCategory:e.displayName.toUpperCase(),usages:[]})))});try{const t=0===s.length?[n.S.get("/statuses",{params:{expand:"workflowUsages,usages"}})]:s.map((e=>n.S.get("/statuses",{params:{projectId:e,expand:"workflowUsages,usages"}}))),i=await Promise.all(t),a=new Map;i.forEach((e=>{e.data.values.filter((e=>e.usages.length>0)).forEach((e=>{a.has(e.name)||a.set(e.name,e)}))}));const r=Array.from(a.values());return r.length>0?{values:r}:await e()}catch(s){if(s instanceof ce.pe&&403===s.response?.status)return await e()}}})})({projectIds:s,opened:r});return(0,m.jsxs)(me.A,{isLoading:d.isFetching,trigger:0===t?.length||void 0===t?"Status":e=>(0,m.jsx)(xe,{title:"Status",values:t,triggerButtonProps:e}),shouldRenderToParent:!0,isOpen:r,onOpenChange:()=>{o(!r)},children:[!d.isLoading&&d.data?.values.map((e=>{const s="TODO"===e.statusCategory&&"default",a="IN_PROGRESS"===e.statusCategory&&"inprogress",n="DONE"===e.statusCategory&&"success",r=s||a||n||"default";return(0,m.jsx)(pe.A,{onClick:()=>{void 0!==t?t.includes(e.name)?i(t.filter((s=>s!==e.name))):i([...t,e.name]):i([e.name])},isSelected:t?.includes(e.name),id:e.name,children:(0,m.jsx)(J.A,{appearance:r,children:e.name})},e.id)})),a]})};var fe=t(49785),Se=t(88764);var ye=t(87657);const Ae=e=>{const{values:s,onChange:t,elemAfterDropdownItems:i}=e,[a,r]=(0,l.useState)(!1),o=(e=>{let{opened:s}=e;return(0,U.I)({queryKey:["projects"],queryFn:e=>n.S.get("/projects",{signal:e.signal}),select:e=>e.data,enabled:s})})({opened:a});return(0,m.jsxs)(me.A,{isLoading:o.isFetching,trigger:0===s?.length||void 0===s?"Project":e=>(0,m.jsx)(xe,{title:"Project",values:s?.map((e=>e.id))||[],triggerButtonProps:e}),shouldRenderToParent:!0,isOpen:a,onOpenChange:()=>{r(!a)},children:[!o.isLoading&&o.data?.values.map((e=>(0,m.jsx)(pe.A,{onClick:()=>{void 0!==s?s.some((s=>s.id===e.id))?t(s.filter((s=>s.id!==e.id))):t([...s,{id:e.id,key:e.key}]):t([{id:e.id,key:e.key}])},isSelected:s?.some((s=>s.id===e.id)),id:e.name,children:(0,m.jsxs)(A.A,{columnGap:"space.050",children:[e?.avatarUrls?.["48x48"]?(0,m.jsx)(V.A,{height:20,width:20,src:e.avatarUrls["48x48"],loading:"lazy"}):(0,m.jsx)(v.A,{xcss:(0,b.S7)({height:"20px",width:"20px"}),children:(0,m.jsx)(ye.A,{label:"Unassigned"})}),(0,m.jsx)(Se.A,{children:e.name})]})},e.id))),i]})};t(31730);var ve=t(41710);const be=e=>{let{user:s,values:t,onChange:i}=e;return(0,m.jsx)(pe.A,{onClick:()=>{void 0!==t?t.includes(s.accountId)?i(t.filter((e=>e!==s.accountId))):i([...t,s.accountId]):i([s.accountId])},isSelected:t?.includes(s.accountId),id:s.name,children:(0,m.jsxs)(A.A,{columnGap:"space.050",children:[s?.avatarUrls?.["48x48"]?(0,m.jsx)(V.A,{height:20,width:20,src:s.avatarUrls["48x48"],loading:"lazy"}):(0,m.jsx)(v.A,{xcss:(0,b.S7)({height:"20px",width:"20px"}),children:(0,m.jsx)(ye.A,{label:"Unassigned"})}),(0,m.jsx)(Se.A,{children:s.displayName})]})},s.accountId)};var Ce=t(49245);const Ie=e=>{const{values:s,onChange:t,elemAfterDropdownItems:i}=e,[a,r]=(0,l.useState)(!1),[o,d]=(0,l.useState)(!1),c=(e=>{let{opened:s}=e;return(0,U.I)({enabled:s,queryKey:["find users"],queryFn:async()=>{const e=(await n.S.get("/user/search",{params:{query:""}})).data;return e.push(ve._),e}})})({opened:a}),u=o?c.data:c.data?.filter(Ce.g);return(0,l.useEffect)((()=>()=>{d(!1)}),[]),(0,m.jsxs)(me.A,{isLoading:c.isFetching,trigger:0===s?.length||void 0===s?"Assignee":e=>(0,m.jsx)(xe,{title:"Assignee",values:s,triggerButtonProps:e}),shouldRenderToParent:!0,isOpen:a,onOpenChange:()=>{r(!a)},children:[!c.isLoading&&u?.map((e=>(0,m.jsx)(be,{values:s,onChange:t,user:e},e.accountId))),(0,m.jsx)(le.A,{shouldFitContainer:!0,onClick:()=>d((e=>!e)),children:o?"Hide":"Show all"}),(0,m.jsx)(v.A,{xcss:(0,b.S7)({marginBottom:"space.100"})}),i]})},ke=e=>{const{projectKeys:s=[],values:t,onChange:i,elemAfterDropdownItems:a}=e,[r,o]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),u=(e=>{const{projectKeys:s,opened:t}=e;return(0,U.I)({enabled:t,queryKey:["assignable multi project search"],queryFn:async()=>{const e=(await n.S.get("/user/assignable/multiProjectSearch",{params:{query:"",projectKeys:s.join(",")}})).data;return e.push(ve._),e}})})({projectKeys:s,opened:r&&s?.length>0}),g=d?u.data:u.data?.filter(Ce.g);return(0,l.useEffect)((()=>()=>{c(!1)}),[]),(0,m.jsxs)(me.A,{isLoading:u.isFetching,trigger:0===t?.length||void 0===t?"Assignee":e=>(0,m.jsx)(xe,{title:"Assignee",values:t,triggerButtonProps:e}),shouldRenderToParent:!0,isOpen:r,onOpenChange:()=>{o(!r)},children:[!u.isLoading&&g?.map((e=>(0,m.jsx)(be,{values:t,onChange:i,user:e},e.accountId))),(0,m.jsx)(le.A,{shouldFitContainer:!0,onClick:()=>c((e=>!e)),children:d?"Hide":"Show all"}),(0,m.jsx)(v.A,{xcss:(0,b.S7)({marginBottom:"space.100"})}),a]})};var we=t(83410);const Ee=e=>{const{values:s,onChange:t,elemAfterDropdownItems:i,projectIds:a}=e,[r,o]=(0,l.useState)(!1),d=(e=>{const{opened:s,projectIds:t}=e;return(0,U.I)({enabled:s,queryKey:["priority schemes"],queryFn:async()=>{const e=async()=>(await n.S.get("/jql-search",{params:{url:"/rest/api/latest/jql/autocompletedata/suggestions?fieldName=priority"}})).data.results.map((e=>({id:e.value,iconUrl:"",name:e.displayName,statusColor:""})));try{const s=await n.S.get("/priorityscheme",{params:{expand:"priorities,projects"}});return 0===s.data.values.length?e():s.data.values.reduce(((e,s)=>(t&&t.length?s.projects.values.some((e=>t.includes(e.id)))&&e.push(...s.priorities.values):e.push(...s.priorities.values),e)),[]).reduce(((e,s)=>(e.some((e=>e.name===s.name))||e.push(s),e)),[])}catch(s){if(s instanceof ce.pe&&403===s.response?.status)return e()}}})})({opened:r,projectIds:a});return(0,m.jsxs)(me.A,{isLoading:d.isFetching,trigger:0===s?.length||void 0===s?"Priority":e=>(0,m.jsx)(xe,{title:"Priority",values:s,triggerButtonProps:e}),shouldRenderToParent:!0,isOpen:r,onOpenChange:()=>{o(!r)},children:[!d.isLoading&&d.data?.map((e=>(0,m.jsx)(pe.A,{onClick:()=>{void 0!==s?s.includes(e.name)?t(s.filter((s=>s!==e.name))):t([...s,e.name]):t([e.name])},isSelected:s?.includes(e.name),id:e.name,children:(0,m.jsxs)(A.A,{columnGap:"space.050",children:[e.iconUrl&&(0,m.jsx)(V.A,{height:20,width:20,src:e.iconUrl,loading:"lazy"}),(0,m.jsxs)(Se.A,{children:[" ",e.name]})]})},e.id))),i]})};var Le=t(15208);let Ne=function(e){return e.ASC="ASC",e.DESC="DESC",e.NONE="",e}({});var Oe=t(48826);const Fe={priority:[],statuses:[],projects:[],assignees:[],prioritySort:Ne.NONE,createdSort:Ne.NONE,statusSort:Ne.NONE,issueSelect:"",search:{value:"",issueIds:[]}},Te=(e,s,t)=>{if(!s?.length)return"";return`${e} in (${(t?s.map(t):s).join(",")})`},Me=e=>{let{onSubmit:s}=e;const{control:t,handleSubmit:i}=(0,fe.xW)(),{field:a}=(0,fe.as)({control:t,name:"search"});return(0,m.jsx)(Le.q,{value:a.value?.value,onChange:e=>{a.onChange(e),i(s)()}})},Re=e=>{let{onSubmit:s}=e;const{control:t,handleSubmit:i,reset:a}=(0,fe.xW)(),{field:n}=(0,fe.as)({control:t,name:"issueSelect"});console.log("field =>",n.value);const r=(0,l.useCallback)((e=>{a(Object.assign(Fe,{issueSelect:e.id})),i(s)()}),[]);return(0,m.jsx)("div",{style:{flexBasis:"100%"},children:(0,m.jsx)(Le.d,{issueId:n.value,onChange:r})})},De=e=>{let{onSubmit:s}=e;const{control:t,handleSubmit:i}=(0,fe.xW)(),a=(0,fe.FH)({control:t,name:"projects"}),{field:n}=(0,fe.as)({control:t,name:"statuses"}),r=e=>{n.onChange(e),i(s)()};return(0,m.jsx)(je,{values:n.value,projectIds:a?.map((e=>e.id)),onChange:r,elemAfterDropdownItems:(0,m.jsx)(le.A,{onClick:()=>r([]),children:"Clear"})})},Pe=e=>{let{onSubmit:s}=e;const{setValue:t,control:i,handleSubmit:a}=(0,fe.xW)(),{field:n}=(0,fe.as)({control:i,name:"projects"}),r=e=>{t("statuses",[]),t("assignees",[]),t("priority",[]),n.onChange(e),a(s)()};return(0,m.jsx)(Ae,{values:n.value,onChange:r,elemAfterDropdownItems:(0,m.jsx)(le.A,{onClick:()=>r([]),children:"Clear"})})},qe=e=>{let{onSubmit:s}=e;const{control:t,handleSubmit:i}=(0,fe.xW)(),a=(0,fe.FH)({control:t,name:"projects"}),n=a?.map((e=>e.key))||[],{field:r}=(0,fe.as)({control:t,name:"assignees"}),o=e=>{r.onChange(e),i(s)()};return n?.length>0?(0,m.jsx)(ke,{projectKeys:n,values:r.value,onChange:o,elemAfterDropdownItems:(0,m.jsx)(le.A,{onClick:()=>o([]),children:"Clear"})}):(0,m.jsx)(Ie,{values:r.value,onChange:o,elemAfterDropdownItems:(0,m.jsx)(le.A,{onClick:()=>o([]),children:"Clear"})})},Ke=e=>{let{onSubmit:s}=e;const{control:t,handleSubmit:i}=(0,fe.xW)(),a=(0,fe.FH)({control:t,name:"projects"}),{field:n}=(0,fe.as)({control:t,name:"priority"}),r=e=>{n.onChange(e),i(s)()};return(0,m.jsx)(Ee,{values:n.value,projectIds:a?.map((e=>e.id)),onChange:r,elemAfterDropdownItems:(0,m.jsx)(le.A,{onClick:()=>r([]),children:"Clear"})})},$e=e=>{let{onSubmit:s}=e;const[t,i]=(0,l.useState)(!1),{setValue:a,control:n,handleSubmit:r}=(0,fe.xW)(),{field:o}=(0,fe.as)({control:n,name:"createdSort",defaultValue:Ne.NONE}),d=e=>{a("prioritySort",Ne.NONE),a("statusSort",Ne.NONE),o.onChange(e),r(s)()};return(0,m.jsxs)(me.A,{isOpen:t,onOpenChange:()=>i(!t),trigger:e=>(0,m.jsx)(xe,{values:o.value,triggerButtonProps:e,title:`Sort by Created Date ${o.value?`(${o.value||""})`:""} `}),children:[(0,m.jsx)(we.A,{id:"asc",isSelected:o.value===Ne.ASC,onClick:()=>d(Ne.ASC),children:Ne.ASC}),(0,m.jsx)(we.A,{id:"desk",isSelected:o.value===Ne.DESC,onClick:()=>d(Ne.DESC),children:Ne.DESC}),(0,m.jsx)(le.A,{onClick:()=>d(Ne.NONE),children:"Clear"})]})},Be=e=>{let{onSubmit:s}=e;const[t,i]=(0,l.useState)(!1),{setValue:a,control:n,handleSubmit:r}=(0,fe.xW)(),{field:o}=(0,fe.as)({control:n,name:"prioritySort",defaultValue:Ne.NONE}),d=e=>{a("createdSort",Ne.NONE),a("statusSort",Ne.NONE),o.onChange(e),r(s)()};return(0,m.jsxs)(me.A,{isOpen:t,onOpenChange:()=>i(!t),trigger:e=>(0,m.jsx)(xe,{values:o.value,triggerButtonProps:e,title:`Sort by Priority ${o.value?`(${o.value||""})`:""} `}),children:[(0,m.jsx)(we.A,{id:"asc",isSelected:o.value===Ne.ASC,onClick:()=>d(Ne.ASC),children:Ne.ASC}),(0,m.jsx)(we.A,{id:"desk",isSelected:o.value===Ne.DESC,onClick:()=>d(Ne.DESC),children:Ne.DESC}),(0,m.jsx)(le.A,{onClick:()=>d(Ne.NONE),children:"Clear"})]})},Ue=e=>{let{onSubmit:s}=e;const[t,i]=(0,l.useState)(!1),{handleSubmit:a,setValue:n,control:r}=(0,fe.xW)(),{field:o}=(0,fe.as)({control:r,name:"statusSort",defaultValue:Ne.NONE}),d=e=>{n("prioritySort",Ne.NONE),n("createdSort",Ne.NONE),o.onChange(e),a(s)()};return(0,m.jsxs)(me.A,{isOpen:t,onOpenChange:()=>i(!t),trigger:e=>(0,m.jsx)(xe,{values:o.value,triggerButtonProps:e,title:`Sort by Status ${o.value?`(${o.value||""})`:""} `}),children:[(0,m.jsx)(we.A,{id:"asc",isSelected:o.value===Ne.ASC,onClick:()=>d(Ne.ASC),children:Ne.ASC}),(0,m.jsx)(we.A,{id:"desk",isSelected:o.value===Ne.DESC,onClick:()=>d(Ne.DESC),children:Ne.DESC}),(0,m.jsx)(le.A,{onClick:()=>d(Ne.NONE),children:"Clear"})]})},We=e=>{let{onSubmit:s}=e;const{reset:t,control:i,handleSubmit:a,setValue:n}=(0,fe.xW)(),r=(0,fe.FH)({control:i}),o=(0,l.useCallback)((e=>"object"==typeof e&&null!==e?Object.values(e).every(o):""===e),[]);return!o(r)&&(0,m.jsx)(le.A,{appearance:"warning",onClick:()=>{t({...Fe,issueSelect:""}),a(s)()},children:"Reset"})},Ge=()=>{const e=(0,fe.mN)({mode:"onChange",defaultValues:(0,Oe.A)(Fe,d.QN.getState().settings.jqlBasic,{clone:!0})}),s=(0,u.jE)(),t=(0,c.BL)({titleLoading:"Searching",titleSuccess:"",titleError:"Filter update error",onSuccess:()=>{s.invalidateQueries({queryKey:["issues"]})}});(0,g.K)(t.error),(0,l.useEffect)((()=>{const{unsubscribe:s}=e.watch(((s,t)=>{"issueSelect"!==t.name&&"change"===t.type&&e.setValue("issueSelect","")}));return s}),[e.watch]);const i=(0,l.useCallback)((e=>{const s=[[Te("issue",e.issueSelect?[e.issueSelect]:[]),Te("issue",e.search?.issueIds),Te("project",e.projects,(e=>e.id)),Te("status",e.statuses,(e=>`"${e}"`)),Te("assignee",e.assignees,(e=>null===e?"null":e)),Te("priority",e.priority)].filter(Boolean).join(" AND "),(e=>{if(0===e.length)return"";const s=e.filter((e=>{let{order:s}=e;return s})).map((e=>{let{field:s,order:t}=e;return`${s} ${t}`}));return s.length>0?`ORDER BY ${s.join(", ")}`:""})([{field:"priority",order:e.prioritySort},{field:"created",order:e.createdSort},{field:"status",order:e.statusSort}])].filter(Boolean).join(" ");t.mutate({settings:{jqlBasic:e,jqlUISearchModeSwitcher:"basic"},jql:s})}),[]);return(0,m.jsx)(A.A,{columnGap:"space.100",rowGap:"space.100",wrap:"wrap",xcss:(0,b.S7)({marginBottom:"space.250"}),children:(0,m.jsxs)(fe.Op,{...e,children:[(0,m.jsx)(Re,{onSubmit:i}),(0,m.jsx)(Me,{onSubmit:i}),(0,m.jsx)(Pe,{onSubmit:i}),(0,m.jsx)(De,{onSubmit:i}),(0,m.jsx)(qe,{onSubmit:i}),(0,m.jsx)(Ke,{onSubmit:i}),(0,m.jsx)($e,{onSubmit:i}),(0,m.jsx)(Be,{onSubmit:i}),(0,m.jsx)(Ue,{onSubmit:i}),(0,m.jsx)(We,{onSubmit:i})]})})},Qe=(0,l.memo)(Ge);var _e=t(20924),ze=t(95995),Ve=t(96871),He=t(54430),Je=t(44531);const Ye=()=>{const{toggle:e,watchBoolean:s}=(0,Ve.HN)(),[t,i]=(0,l.useState)(!1),a=(0,F.P7)((e=>e.favorites)),[n]=s("FAVORITE LIST"),{reasonLoading:r,onAddNewGroup:o}=(0,F.hO)();return(0,l.useEffect)((()=>()=>{i(!1)}),[n]),(0,m.jsx)(v.A,{xcss:(0,b.S7)({marginBottom:"space.300"}),children:(0,m.jsxs)(A.A,{alignItems:"center",justifyContent:"center",columnGap:"space.050",xcss:(0,b.S7)({backgroundColor:"color.background.neutral",cursor:"pointer",paddingBottom:"space.100",paddingTop:"space.100"}),children:[(0,m.jsx)(ze.A,{label:"Favorite"}),(0,m.jsxs)(v.A,{xcss:(0,b.S7)({display:"flex",alignItems:"center",columnGap:"space.050"}),onClick:()=>{e("FAVORITE LIST")},children:[(0,m.jsxs)(Z.A,{size:"small",children:["Favorite list ",a.length?`(${a.length})`:""]}),n?(0,m.jsx)(_.A,{label:"arrow up favorite"}):(0,m.jsx)(z.default,{label:"arrow down favorite"})]}),n&&(0,m.jsx)(Je.z,{isOpen:t,onClose:()=>i((e=>!e)),content:()=>(0,m.jsx)(F.dJ,{children:(0,m.jsx)(F.$q,{isLoading:r===F.iq.add,onAdd:o})}),trigger:e=>(0,m.jsx)(v.A,{...e,as:"div",xcss:(0,b.S7)({"& > button":{height:"20px"}}),onClick:e=>{e.stopPropagation(),i((e=>!e))},children:(0,m.jsx)(S.A,{icon:He.A,label:"add favorite group",isLoading:r===F.iq.add})})})]})})},Xe=(0,l.lazy)((()=>t.e(345).then(t.bind(t,46345))));var Ze=t(94969);const es=()=>{const[e,s]=(0,l.useState)(d.QN.getState().settings.jqlUISearchModeSwitcher);return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(A.A,{xcss:(0,b.S7)({marginBottom:"space.100",justifyContent:"space-between"}),children:[(0,m.jsx)(Z.A,{size:"xlarge",children:"Issues"}),(0,m.jsxs)(A.A,{columnGap:"space.050",children:[(0,m.jsx)(_e.A,{value:"BASIC",label:"BASIC",name:"basic",testId:"radio-default",isChecked:"basic"===e,onChange:()=>s("basic"),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0}),(0,m.jsx)(_e.A,{value:"JQL",label:"JQL",name:"jql",testId:"radio-disabled",isChecked:"jql"===e,onChange:()=>s("jql"),onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]})]}),"jql"===e?(0,m.jsx)(h,{}):(0,m.jsx)(Qe,{}),(0,m.jsx)(Ye,{}),(0,m.jsx)(Ve.s9,{name:"FAVORITE LIST",children:e=>{let{localState:s}=e;const[t]=s;return(0,m.jsx)(l.Suspense,{fallback:(0,m.jsx)(ue.A,{}),children:t&&(0,m.jsx)(Xe,{})})}}),(0,m.jsx)(ne,{}),(0,m.jsx)(ge,{}),(0,m.jsx)(Ve.s9,{name:"LOG_TIME_ISSUE",children:e=>{let{localState:s}=e;const[t,{data:i}]=s,a=i;return(0,m.jsx)(Ze.A,{children:t&&(0,m.jsx)(I.e,{issueId:a})})}})]})};var ss=t(47767);const ts=()=>{const e=(0,ss.r5)();return(0,m.jsx)(C.A,{title:"An error occurred within the application",appearance:"error",children:e.response?.data?.errorMessages?.join(", ")??JSON.stringify(e.response?.data)})}},75396:(e,s,t)=>{t.d(s,{g:()=>B,e:()=>_});var i=t(94203),a=t(29731),n=t(73750),r=t(27779),o=t(40313),l=t(96871),d=t(60659),c=t(64561),u=t(49785),g=t(17673),m=t(57464),p=t(23048),h=t(65251),x=t(15490),j=t(53857),f=t(52340),S=t(88764),y=t(97665),A=t(74353),v=t.n(A),b=t(8290),C=t(12596),I=t(4513),k=t(76234),w=t(99253),E=t(35806),L=t(62494),N=t(97066),O=t(24681),F=t(3973),T=t(96540),M=t(15208),R=t(58124),D=t(67898),P=t(88811),q=t(5800),K=t(74848);const $={date:v()().format(E.D),timeSpent:"",description:"",worklog:void 0},B=e=>(0,K.jsx)(d.A,{appearance:e.appearance??"discovery",onClick:()=>{l.vR.setTrue("LOG_TIME_ISSUE",e.issueId)},children:"Log time"}),U=(0,T.memo)((e=>{const{id:s,onCopy:t,onDelete:i,onSelect:a,issueId:n,isSelected:r,isLoading:o,description:l,timeSpentSeconds:d,date:u,authorAvatarUrl:g,authorDisplayName:m}=e;return(0,K.jsxs)(x.A,{xcss:(0,j.S7)({boxShadow:"elevation.shadow.overlay",display:"grid",gap:"space.100",borderRadius:"border.radius.200",marginBottom:"space.200",padding:"space.200",cursor:"pointer",backgroundColor:r?"color.background.accent.blue.subtler":"color.background.input"}),onClick:()=>{a(!!r,s)},children:[(0,K.jsxs)(f.A,{wrap:"wrap",gap:"space.100",columnGap:"space.250",children:[(0,K.jsxs)(f.A,{columnGap:"space.100",children:[(0,K.jsx)(S.A,{weight:"bold",children:"User:"}),(0,K.jsxs)(f.A,{columnGap:"space.100",children:[(0,K.jsx)(b.A,{src:g,height:"20px",width:"20px"}),(0,K.jsx)(S.A,{weight:"regular",children:m})]})]}),(0,K.jsxs)(f.A,{columnGap:"space.100",children:[(0,K.jsx)(S.A,{weight:"bold",children:"Date:"}),(0,K.jsx)(S.A,{weight:"regular",children:u})]}),(0,K.jsxs)(f.A,{columnGap:"space.100",children:[(0,K.jsx)(S.A,{weight:"bold",children:"Logged:"}),(0,K.jsx)(S.A,{weight:"regular",children:(0,O.M)(d,!0)})]})]}),(0,K.jsxs)(f.A,{columnGap:"space.100",children:[(0,K.jsx)(x.A,{xcss:(0,j.S7)({flexShrink:0}),children:(0,K.jsx)(S.A,{weight:"bold",children:"Description: "})}),(0,K.jsx)(S.A,{weight:"regular",children:l})]}),(0,K.jsxs)(f.A,{justifyContent:"end",columnGap:"space.100",children:[(0,K.jsx)(c.A,{icon:k.A,label:"Copy",onClick:e=>{e.stopPropagation(),t(s)}}),(0,K.jsx)(F.w,{id:`issue-worklog-delete-${n}`,title:"Are you sure you want to delete this worklog?",stopPropagation:!0,isLoading:o,onYes:()=>{i(n,s)}})]})]})})),W=(0,T.memo)((e=>{let{control:s}=e;return(0,K.jsx)(u.xI,{name:"date",control:s,rules:{required:"Required"},render:e=>{let{field:s,fieldState:t}=e;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(m.JU,{htmlFor:"date",children:"Date"}),(0,K.jsx)(w.A,{value:s.value,label:"date",placeholder:E.D,dateFormat:E.D,onChange:s.onChange}),!!t.error?.message&&(0,K.jsx)(p.Kw,{children:t.error?.message})]})}})})),G=(0,T.memo)((e=>{let{control:s}=e;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(u.xI,{name:"timeSpent",control:s,rules:{required:"Required"},render:e=>{let{field:s,fieldState:t}=e;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(m.JU,{htmlFor:"timeSpent",children:"Time spent"}),(0,K.jsx)(g.A,{value:s.value,id:"timeSpent",onChange:s.onChange,onBlur:s.onBlur,placeholder:"Use the format 2w 3d 4h 5m"}),!!t.error?.message&&(0,K.jsx)(p.Kw,{children:t.error?.message})]})}}),(0,K.jsx)(L.V,{})]})})),Q=(0,T.memo)((e=>{let{control:s}=e;return(0,K.jsx)(x.A,{xcss:(0,j.S7)({paddingBottom:"space.100"}),children:(0,K.jsx)(u.xI,{name:"description",control:s,render:e=>{let{field:s}=e;return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(m.JU,{htmlFor:"description",children:"Description"}),(0,K.jsx)(I.A,{resize:"vertical",value:s.value,id:"Description",onChange:s.onChange,onBlur:s.onBlur,placeholder:"Description",onPointerEnterCapture:void 0,onPointerLeaveCapture:void 0})]})}})})})),_=e=>{const{issueId:s}=e,{setFalse:t}=(0,l.HN)(),[g,m]=(0,T.useState)(!1),p=(0,y.jE)(),[f,S]=(0,T.useState)(s),A=(0,T.useRef)(null),v=(0,T.useRef)(!1),{handleSubmit:b,control:I,setValue:k,reset:w,getValues:E}=(0,u.mN)({mode:"onBlur",defaultValues:$}),{remove:L}=(0,D.b)(f),{worklogPUT:F,issueWorklogs:B,worklogPOST:_,worklogDELETE:z,wasMutationSuccessfulAndCacheCleared:V}=(0,N.r)({issueId:f,enabledGetWorklogs:!1,enabledGetIssueWorklogs:!0,mutationGcTime:1/0,post:{onSuccess:()=>{v.current&&L(f),w($)}},put:{onSuccess:()=>{v.current&&L(f),w($)}},delete:{onSuccess:e=>{v.current&&L(f),E("worklog")?.id===e.id&&w($)}}}),H=(0,T.useMemo)((()=>{if(B.data){const e=B.data.reduce(((e,s)=>e+s.timeSpentSeconds),0);return(0,O.M)(e,!0)}return""}),[B.data]),J=(0,T.useCallback)((e=>{S(e.id)}),[]),Y=(0,T.useCallback)(((e,s)=>{if(e)k("worklog",void 0),k("timeSpent",""),k("description",""),k("date","");else if(A.current){const e=A.current.find((e=>e.id===s));e&&(k("worklog",e),k("timeSpent",e.timeSpent),k("description",e.description),k("date",e.date))}}),[]),X=(0,T.useCallback)((e=>{if(A.current){const s=A.current.find((s=>s.id===e));s&&(k("timeSpent",s.timeSpent),k("description",s.description),k("worklog",void 0))}}),[]),Z=(0,T.useCallback)(((e,s)=>{z.mutate({issueId:e,id:s})}),[]),ee=(0,T.useCallback)((e=>{e.worklog?F.mutate({issueId:f,id:e.worklog.id,timeSpent:e.timeSpent,startDate:e.date,description:e.description}):_.mutate({issueId:f,startDate:e.date,timeSpent:e.timeSpent,description:e.description})}),[]),se=(0,T.useCallback)((async()=>{V()&&(m(!0),await p.invalidateQueries(),m(g)),t("LOG_TIME_ISSUE")}),[]),te=(0,T.useCallback)((e=>{const s=E("timeSpent"),t=R.QN.getState().settings.workingDaysPerWeek,i=R.QN.getState().settings.workingHoursPerDay;if(s){const a=(0,P.f5)(s,t,i);k("timeSpent",(0,q.j)(a+e,t,i))}else k("timeSpent",(0,q.j)(e,t,i));v.current=!0}),[]);return(0,T.useEffect)((()=>{A.current=B.data??null}),[B.data]),(0,K.jsxs)(i.A,{onClose:se,children:[(0,K.jsxs)(a.A,{children:[(0,K.jsx)(n.A,{children:"Log time"}),(0,K.jsx)(c.A,{isLoading:g,appearance:"subtle",icon:h.A,label:"Close Modal",onClick:se})]}),(0,K.jsxs)(r.A,{children:[(0,K.jsx)(D.P,{issueId:f,isAddToTimeSpentAction:!0,isLogTimeAction:!1,onAddToTimeSpent:te}),(0,K.jsx)(x.A,{xcss:(0,j.S7)({margin:"space.200"})}),(0,K.jsx)(M.d,{issueId:f,onChange:J}),(0,K.jsx)(x.A,{xcss:(0,j.S7)({margin:"space.150"})}),(0,K.jsx)(W,{control:I}),(0,K.jsx)(x.A,{xcss:(0,j.S7)({margin:"space.150"})}),(0,K.jsx)(G,{control:I}),(0,K.jsx)(x.A,{xcss:(0,j.S7)({margin:"space.150"})}),(0,K.jsx)(Q,{control:I}),(0,K.jsxs)(x.A,{xcss:(0,j.S7)({paddingTop:"space.150",paddingBottom:"space.100"}),children:[!!B.data?.length&&(0,K.jsx)(x.A,{xcss:(0,j.S7)({marginBottom:"space.075"}),children:(0,K.jsx)(C.A,{size:"small",children:"Worklogs:"})}),!B.isLoading&&B?.data&&B?.data?.length>0&&(0,K.jsx)(x.A,{xcss:(0,j.S7)({textAlign:"center",marginBottom:"space.200",backgroundColor:"color.background.neutral",padding:"space.100",borderRadius:"border.radius.200"}),children:(0,K.jsxs)(C.A,{as:"h2",size:"small",children:["Total time: ",H]})}),(0,K.jsx)(u.xI,{name:"worklog",control:I,render:e=>{let{field:s}=e;return(0,K.jsx)(K.Fragment,{children:B.data?.map((e=>(0,K.jsx)(U,{id:e.id,isSelected:s.value?.id===e.id,isLoading:z.variables?.id===e.id&&z.isPending,date:e.date,issueId:f,timeSpentSeconds:e.timeSpentSeconds,description:e.description,authorAvatarUrl:e.author.avatarUrls["16x16"],authorDisplayName:e.author.displayName,onDelete:Z,onCopy:X,onSelect:Y},e.id)))})}})]})]}),(0,K.jsxs)(o.A,{children:[(0,K.jsx)(d.A,{isLoading:g,appearance:"default",onClick:se,children:"Cancel"}),(0,K.jsx)(d.A,{isLoading:F.isPending||_.isPending,onClick:b(ee),appearance:"primary",children:"Save"})]})]})}}}]);